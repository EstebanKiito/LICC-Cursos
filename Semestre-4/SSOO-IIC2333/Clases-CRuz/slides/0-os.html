<!DOCTYPE html><html lang="es"><head><!--[if IE]><!--Get a real browser!--><![endif]--><!--Do NOT read this file, the source is available--><meta charset="utf-8" /><title>0 - Estructura y Funcionamiento de Sistemas Operativos</title><meta content="IIC2333 - Sistemas Operativos y Redes" name="description" /><meta name="author" /><meta content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, minimal-ui" name="viewport" /><meta content="yes" name="apple-mobile-web-app-capable" /><meta content="black-translucent" name="apple-mobile-web-app-status-bar-style" /><link href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/css/reveal.min.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/css/theme/white.min.css" id="theme" rel="stylesheet" /><link href="https://github.com/frederickf/presentable/raw/master/src/presentable.css" rel="stylesheet" /><link href="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/lib/css/zenburn.min.css" rel="stylesheet" /></head><body><div class="reveal"><div class="slides"><section><h2>Sistemas Operativos y Redes</h2><h1>0 - Estructura y Funcionamiento de Sistemas Operativos</h1><p>Semestre 2022-1<br/>Cristian Ruz - cruz@ing.puc.cl</p><p style="padding-top:4em;">Departamento de Ciencia de la Computación<br/>Pontificia Universidad Católica de Chile</p></section><section><h2>¿Para qué un Sistema Operativo?</h2><section></section><section><div>Queremos ejecutar un código como esto</div><img src="../images/figures/00-main.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="20%" /><div class="fragment" data-fragment-index="1" style="border:none; width:20%; vertical-align:middle; display:inline-block;">más bien esto</div><div class="fragment" data-fragment-index="1" style="border:none; width:30%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-compiled.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="70%" /></div><div><div class="fragment" data-fragment-index="2" style="border:none; width:30%; vertical-align:middle; display:inline-block; horizontal-align:right;">Y para eso tenemos:</div><div class="fragment" data-fragment-index="2" style="border:none; width:25%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-motherboard.jpg" style="background:none; border:none; box-shadow:none;" width="100%" /></div></div><div class="fragment" data-fragment-index="2" style="font-size:12px;">Source: https://www.soundonsound.com/techniques/installing-new-pc-motherboard</div></section><section><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="border:none;horizontal-align:left;"><i>Hardware</i> ejecuta ciclos de instrucciones</div><ul style="font-size:28px;horizontal-align:left;"><li><i>Fetch</i></li><li><i>Decode</i></li><li><i>Execute</i></li></ul><br /><br /><div><i>Hardware</i> ejecuta programas (código) compilado</div><ul class="fragment" data-fragment-index="1" style="font-size:28px;"><li>¿Cuál programa? ¿En qué orden?</li><li>¿Un programa a la vez?</li><li>¿En qué región de memoria?</li><li>¿Cómo utiliza los dispositivos de I/O?</li></ul></div><img src="../images/figures/00-instructioncycle-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="20%" /></section><section><div>El computador es una máquina programable (léase "reconfigurable") &hellip;</div><div style="font-size:24px;">&hellip; pero electrónicamente compleja</div><div><img src="../images/figures/00-vonneumann-opt.svg" style="background:none; border:none; box-shadow:none;" width="35%" /></div><div class="fragment" data-fragment-index="1">Cuando ejecutamos un programa ...</div><ul class="fragment" data-fragment-index="1" style="font-size:24px;"><li>No nos preocupamos del <i>hardware</i> del computador</li><li>No tenemos que esperar que otro programa termine para que el nuestro ejecute</li><li>No especificamos qué región de la memoria va a utilizar</li><li>No decidimos en que bloques del disco está almacenado</li></ul><blockquote class="fragment" data-fragment-index="2" style="background:#B7E1CD;">Porque afortunadamente existe el <b>Sistema Operativo</b> &#x1f605;</blockquote><div class="fragment" data-fragment-index="2" style="font-size:18px;">Afortunadamente también tenemos compiladores, pero en este curso alabaremos al sistema operativo</div></section></section><section><h2>Estructura de un Sistema Operativo</h2><section></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%"><div>¿Dónde vive el Sistema Operativo?</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><div class="fragment" data-fragment-index="1">Sistema Operativo <b>ES</b> <i>software</i></div><div class="fragment" data-fragment-index="1">Sistema Operativo <b>habla con</b> el <i>hardware</i></div><br /><div class="fragment" data-fragment-index="2">El <b>Sistema Operativo</b> es nuestro <b>servidor</b> más importante</div><ul class="fragment" data-fragment-index="3" style="font-size:36px;"><li>Nos <b>protege</b> de los detalles del <i>hardware</i></li><ul class="fragment" data-fragment-index="4" style="font-size:20px;"><li>¿Un core, dos core?, ¿4GB RAM?, ¿disco SSD?, &hellip; úselo no más, yo me encargo</li></ul><li>Nos permite <b>compartir recursos</b> con otros programas</li><ul class="fragment" data-fragment-index="4" style="font-size:20px;"><li>¿Quiere navegar, tocar música, jugar WoW, compilar su tarea, todo al mismo tiempo? No se preocupe</li></ul><li>Nos ofrece <b>servicios</b> para hacer más cómodo el uso del <i>hardware</i></li><ul class="fragment" data-fragment-index="4" style="font-size:20px;"><li>Escritura y lectura de disco, envío de mensajes por red, acceso a su pendrive USB, y todo eso &hellip; con una interfaz gráfica</li></ul></ul><blockquote class="fragment" data-fragment-index="5" style="background:#B7E1CD;">Nos permite <b>usar</b> el computador &#x1f603;</blockquote><div class="fragment" data-fragment-index="5" style="font-size:14px;">¿Como no querer/estudiar a nuestro sistema operativo?</div></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-monkey-user.gif" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="50%" /><img src="../images/figures/00-oslayers-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>¿Qué esperamos de un sistema operativo?</div><div>¡TODO lo bueno!</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><ul><li>Que sea <b>confiable</b> (<i>reliable</i>)</li><ul style="font-size:20px;"><li>"Que no se caiga/bloquee/cuelgue"</li></ul><li>Que mis programas ejecuten rápidamente</li><ul style="font-size:20px;"><li>"Para eso tengo mis 8 core y mis 128GB RAM"</li><li>"Así puedo jugar, compilar, ver películas, etc. al mismo tiempo"</li></ul><li>Que no gaste todos los recursos (CPU, memoria, disco)</li><ul style="font-size:20px;"><li>"Este Windows/Linux/MacOSX cada vez consume más"				</li></ul><li>Que mis datos estén seguros: que no me hackeen</li><li>Que mis programas sigan funcionando después de una actualización</li><li>Que me permita usar el computador (que no me moleste)</li></ul></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>Debe cumplir varios roles</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><ul><li>Debe ser un <b>administrador de recursos</b></li><ul style="font-size:20px;"><li>¿A quién le toca ejecutar? ¿Qué recursos necesita?</li><li>¿Qué CPU uso? ¿En qué disco escribo?</li><li>Sistema Operativo <b>multiplexa</b> recursos escasos entre múltiples usuarios</li></ul><li>Debe ser capaz de <b>proteger</b> los recursos</li><ul style="font-size:20px;"><li>"No tiene permisos para leer/escribir esos archivos"</li><li>"No intente leer la memoria de otro proceso"</li><li>"¿Quién es este usuario?"</li></ul><li>Debe ser capaz de <b>abstraernos</b> de los detalles del <i>hardware</i></li><ul style="font-size:20px;"><li>Permite que el sistema se vea como una máquina única</li><li>¿AMD, Intel, Samsung, Seagate?, no importa, aquí tiene una máquina con: CPU, memoria y disco.</li><li>Provee una <b>interfaz</b> para poder usar apropiadamente el <i>hardware</i></li><li>Sistema Operativo <b>virtualiza</b> recursos para hacernos creer que hay más</li></ul></ul></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div><div>El sistema operativo es como el <b>gobierno</b> &hellip; no sirve para nada por sí solo &hellip;</div><div>&hellip; pero es <b>fundamental</b> para que podamos usar programas</div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>¿Qué hay dentro de un sistema operativo?</div><div style="border:none; width:30%; vertical-align:middle; display:inline-block; text-align:left;"><ul><li>Administración de procesos</li><li>Manejo de memoria</li><li>Sistemas de archivos</li><li>Protección y seguridad</li><li>Control de I/O</li></ul></div><div style="border:none; width:30%; vertical-align:middle; display:inline-block; text-align:left;"><ul><li>Manejo de errores</li><li>Comunicación inter-procesos</li><li>Contabilidad / <i>logging</i></li><li>Controladores (<i>drivers</i>)</li><li>etc &hellip;</li></ul></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers2-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div><div>Programas utilizan <b>servicios</b> del sistema operativo. ¿Cómo los invocan?</div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>¿Cómo se invocan los servicios del sistema operativo?</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">Sistema operativo provee una interfaz de <b>llamadas al sistema</b> (<i>syscalls</i>)</div><br /><ul style="font-size:24px;"><li>Cada vez que un programa desea solicitar algo al sistema operativo, debe invocar una <i>syscall</i></li><li>"Por favor, sistema operativo, haz esto por mi"</li><li>Cada sistema operativo puede proveer un conjunto distinto de <i>syscalls</i></li><li>Sistemas operativos proveen bibliotecas (<i>libraries</i>) en algún lenguaje de programación (C) para invocar <i>syscalls</i>.</li></ul></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers3-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div><div>Sin embargo, cuando interactuamos con el computador no escribimos <i>syscalls</i></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>¿Cómo interactuamos con el sistema operativo?</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">Sistema operativo provee <b>interfaces de usuario</b> (<i>user interface</i>) que enmascara <i>syscalls</i></div><ul style="font-size:24px;"><li>Ofrecen un entorno más "amigable" para usar el computador</li><li>¿Son parte del sistema operativo?</li></ul><br /><div style="text-align:left;">Distintas maneras de interactuar con el sistema operativo</div><ul style="font-size:24px;"><li><b>Interfaces gráficas</b>: <b>GUI</b> (<i>Graphical User Interface</i>)</li><li><b>Intérprete de comandos</b> (<i>Command Line</i>)</li><li><b>Batch</b> (lotes): secuencias de comandos no-interactivas</li></ul></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers4-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>Interfaces gráficas: GUI</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">GUIs ofrecen un entorno basado en abstracciones (ventanas, punteros) para interactuar con el sistema operativo</div><img src="../images/figures/00-CDE.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-XFCE.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-tonystark.gif" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-KDE.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-windows-10.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-macosx.jpg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers4-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>Intérprete de comandos / linea de comandos / <i>command line</i></div><div style="font-size:12px;">menos preciso: <i>shell</i>, terminal, consola, xterm, prompt</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><div><ul><li>UNIX/Linux/MacOSX: <code>sh</code>, <code>csh</code>, <code>tcsh</code>, <code>ksh</code>, <code>bash</code>, <code>zsh</code></li><li>MS-DOS/Windows: <code>COMMAND.COM</code>, <code>cmd.exe</code>, PowerShell</li></ul></div><div><img src="../images/figures/00-bash.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-hacker-console.gif" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-zsh.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="30%" /><img src="../images/figures/00-commandcom.jpg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="40%" /><img src="../images/figures/00-powershell.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="40%" /></div></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers4-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>Intérprete de comandos / linea de comandos / <i>command line</i></div><div style="font-size:12px;">menos preciso: <i>shell</i>, terminal, consola, xterm, prompt</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><ul><li>Solicitar comando/instrucción al usuario y ejecutarlo</li><li><code>prompt comando [parametros]</code></li></ul><div><p><em>Command Prompt</em> (símbolo del sistema)</p><ul class="fragment"><li>Indica que el sistema está listo para recibir un comando</li><li>Usualmente un texto terminado en <code>$, %, #, :, ></code></li></ul></div><div class="fragment"><pre><code class="hljs shell">cruz$ ls

jabaier@grima$ cp clase-01.tex backup/

jnavon@www[15:35]:> rm tareaSistOp.*

dietr1ch@nb# ~/SO/Tareas
ls -d */ | parallel --tag 'cd {} && make'</code></pre></div></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers4-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div><div>Hay <a href="https://en.wikipedia.org/wiki/List_of_command-line_interpreters" target="_blank">muchas alternativas</a></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><blockquote style="background: #F4C7C3;">El <b>kernel</b> (núcleo, supervisor)</blockquote><div style="text-align:left;">El código fundamental del sistema operativo.</div><ul style="font-size:24px;"><li>Es <i>software</i></li><li>Suele ser lo más pequeño posible (o no)</li></ul><div style="text-align:left;">Tiene completo control sobre el sistema (<i>hardware</i>)</div><ul style="font-size:24px;"><li>Es el único programa que ejecuta en un <b>modo privilegiado</b></li><li>También conocido como <b>modo monitor</b>, <b>modo kernel</b>, <b>modo sistema</b></li><li>Todo lo que no es parte del <i>kernel</i>, ejecuta en <b>modo usuario</b></li></ul><div style="text-align:left;">Sistema operativo incluye herramientas (programas) que facilitan la labor del kernel, pero que no son fundamentales</div></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers5-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div><blockquote style="background: #B7E1CD;">Sistema Operativo = Kernel + Programas del Sistema</blockquote></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>¿De qué tamaño es todo esto?</div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><ul class="fragment"><li>MacOSX (Tiger, 2005): \( \sim 86 \times 10^6 \) líneas de código</li><li>Windows 10: \( \sim 50\times 10^6 \) líneas de código</li><li><a href="https://www.linuxcounter.net/statistics/kernel">Linux</a> 4.14: \( \sim 20\times 10^6 \) líneas de código</li><ul style="font-size:14px;"><li>Version 1.0.0 (Marzo 1994) tenía 176250 líneas</li><li>Kernel Linux está en archivo <code>vmlinuz</code> (Virtual Memory LINUx gZip)</li></ul><li>ChromeOS: \( 17 \times 10^6 \) líneas de código</li><li>MINIX 3: \( \sim 12000 \) líneas de código</li></ul><div class="fragment">Más <a href="http://www.informationisbeautiful.net/visualizations/million-lines-of-code">comparaciones</a> y <a href="https://en.wikipedia.org/wiki/Comparison_of_operating_systems">más aún</a></div></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers5-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%" data-transition="fade"><div>El sistema operativo es un <i>software</i> <b>complejo</b></div><div>A veces fallan ... </div><div style="border:none; width:60%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">Errores y vulnerabilidades pueden deberse a una combinación entre el <i>hardware</i> y el sistema operativo</div><ul><li>O en las herramientas del <i>kernel</i></li></ul><div><a href="http://heartbleed.com/"><img src="../images/figures/00-heartbleed.png" width="20%" style="background:none; border:none; box-shadow:none; vertical-align:middle;"></a><a href="https://meltdownattack.com/"><img src="../images/figures/00-meltdown-spectre.png" width="40%" style="background:none; border:none; box-shadow:none; vertical-align:middle;"></a><a href="https://www.statista.com/chart/7478/android-is-the-most-vulnerable-operating-system/"><img src="../images/figures/00-vulnerabilities.jpg" width="40%" style="background:none; border:none; box-shadow:none; vertical-align:middle;"></a></div></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers5-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div><div><a href="https://cve.mitre.org/">Common list of Vulnerabilities and Exposures (CVE)</a></div></section></section><section data-background-image="../images/figures/00-os-list.png" data-background-size="50%"><h2>Sistema Operativo</h2><blockquote style="background: #B7E1CD;">La herramienta de <i>software</i> que nos permite <b>usar</b> el computador</blockquote><div style="border:none; width:30%; vertical-align:middle; display:inline-block;"><h3>Roles</h3><ul><li>Administrador de recursos</li><li>Protector</li><li>Servidor</li></ul></div><div style="border:none; width:35%; vertical-align:middle; display:inline-block;"><h3>Tareas</h3><ul><li><b>Administración de procesos</b></li><li><b>Manejo de memoria</b></li><li><b>Sistemas de archivos</b></li><li>Protección y seguridad</li><li>Control de dispositivos I/O</li></ul></div><div style="border:none; width:30%; vertical-align:middle; display:inline-block;"><h3>Arquitecturas</h3><ul><li>Monolítico</li><li>Microkernel</li><li>Híbrido</li></ul></div><blockquote style="background: #B7E1CD;">Sistema Operativo = Kernel + Herramientas</blockquote><div><a href="https://xkcd.com/1508/"><img alt="Operating Systems" src="https://imgs.xkcd.com/comics/operating_systems.png" style="background:none; border:none; box-shadow:none;" title="One of the survivors, poking around in the ruins with the point of a spear, uncovers a singed photo of Richard Stallman. They stare in silence. &quot;This,&quot; one of them finally says, &quot;This is a man who BELIEVED in something.&quot;" width="60%" /></a><div style="font-size:12px;"><a href="https://explainxkcd.com/1508/">Explicación</a></div></div></section><section><h2>Arquitecturas de <i>kernel</i></h2><section></section><section><div>¿Cómo se organiza el <i>kernel</i>?</div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">Muchos componentes a integrar</div><ul style="font-size:28px;"><li>Primeros sistemas operativos empezaron pequeños y luego crecieron</li><li>No tenían mucha estructura</li></ul><div style="text-align:left;">MS-DOS (1981)</div><ul style="font-size:28px;"><li>Sistema <b>monolítico</b> (un gran <i>kernel</i> estático)</li><li>Programas de usuario podían acceder directamente al <i>hardware</i></li><li><i>Hardware</i> (Intel 8088) no proveía modos de protección</li></ul><img src="../images/figures/00-2_11.pdf.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="40%" /></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers5-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="90%" /></div></section><section data-transition="fade"><div><i>Kernel</i> monolítico</div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">Todo dentro en un único programa</div><ul style="font-size:28px;"><li>Servicios para el sistema y para el usuario en el mismo espacio</li><li>Todos los servicios se ejecutan en modo <i>kernel</i></li><li>La falla de un servicio compromete al <i>kernel</i></li><li>Kernel complejo y de mayor tamaño</li><li>Ejecución más rápida</li></ul><br /><br /><div style="text-align:left;">Ejemplos</div><ul style="font-size:28px;"><li>Unix (BSD, System V)</li><li><a href="https://www.kernel.org/">Linux</a></li><li>MS-DOS, Windows 95/98/Me</li></ul></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-osmonolithic-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-transition="fade"><div><i>Kernel</i> monolítico con módulos</div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">Todo en un único programa extensible</div><ul style="font-size:28px;"><li>Componentes pueden ser incluidos al momento de compilar, o bien durante la ejecución como módulos</li><li>Módulos extienden al <i>kernel</i></li><li>Módulos se ejecutan en el espacio del <i>kernel</i></li><li>Ayuda a controlar el tamaño del <i>kernel</i> (<i>footprint</i>)</li></ul></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-osmonolithic-modules-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-transition="fade"><div><i>Microkernel</i></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">Mantener el <i>kernel</i> del menor tamaño posible</div><ul style="font-size:28px;"><li>Solo servicios básicos en el <i>kernel</i></li><li>Funcionalidades (<i>servers</i>) se ejecutan en <i>user space</i></li><li>Errores en los servicios no afectan al <i>kernel</i></li><li>Kernel más sencillo, pequeño y fácil de portar</li><li>Procesos se comunican (IPC) mediante paso de mensajes</li><li>Ejecución con <i>overhead</i> por comunicación</li></ul><br /><br /><div style="text-align:left;">Ejemplos</div><ul style="font-size:28px;"><li><a href="http://www.cs.cmu.edu/afs/cs/project/mach/public/www/mach.html">Mach</a>, implementación de UNIX con microkernel (CMU)</li><li><a href="http://hurd.gnu.org/">GNU/Hurd</a>, inspirado en <a href="https://www.gnu.org/software/hurd/microkernel/mach/gnumach.html">Mach</a></li><li><a href="https://en.wikipedia.org/wiki/L4_microkernel_family">L4</a></li><li><a href="http://www.minix3.org/">MINIX 3</a>, desarrollado por Andrew S. Tanenbaum</li></ul><div style="text-align:left;">Se han propuesto <i>exokernels</i> y <i>nanokernels</i></div></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-osmicrokernel-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-transition="fade"><div><i>Kernel</i> híbrido</div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">&quot;Lo mejor&quot; de ambos mundos</div><ul style="font-size:28px;"><li>Construido como monolítico con módulos</li><li>Con funcionalidades que ejecutan en <i>user space</i></li><li>O <i>marketing</i> según <a href="https://www.realworldtech.com/forum/?threadid=65915&curpostid=65936" title="As to the whole &quot;hybrid kernel&quot; thing - it's just marketing. It's &quot;oh, those microkernels had good PR, how can we try to get good PR for our working kernel? Oh, I know, let's use a cool name and try to imply that it has all the PR advantages that that other system has&quot;">Linus Torvalds</a></li></ul><br /><br /><div style="text-align:left;">Ejemplos</div><ul style="font-size:28px;"><li><a href="http://www.microsoft.com/windows">Windows NT</a></li><li><a href="https://www.reactos.org/">ReactOS</a></li><li><a href="http://opensource.apple.com/source/xnu/">XNU</a>, kernel de Darwin (Mac OS X, iOS)</li></ul></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oshybrid-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section><div>Monolítico vs Microkernel</div><div style="font-size:24px;">Must read: <a href="http://www.oreilly.com/openbook/opensources/book/appa.html">Tanenbaum-Torvals debate&colon; <i>Linux is obsolete</i></a>, 1992</div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:center;"><b>Monolítico</b></div><ul style="font-size:28px;"><li><i>Kernel</i> de mayor tamaño y complejo</li><li>Todos los servicios en <i>kernel space</i></li><li>Falla en un servicio afecta a todo el <i>kernel</i></li><li>Ejecución más rápida</li><li>Difícil de extender, pero puede usar módulos</li></ul></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:center;"><b>Microkernel</b></div><ul style="font-size:28px;"><li><i>Kernel</i> pequeño y simple</li><li>Servicios mínimos en <i>kernel space</i>. Mayoría en <i>user space</i></li><li>Falla en un servicio queda aislada</li><li>Ejecución con <i>overhead</i> por comunicación</li><li>Fácil de extender</li></ul></div><div style="border:none; width:100%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-osarchitectures-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section></section><section><h2>¿Cómo funciona el Sistema Operativo?</h2><section></section><section><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><div style="text-align:left;">El sistema operativo efectúa muchas tareas, pero &hellip; ¿cuando le toca el usuario?</div><br /><div style="text-align:left;">Y si ahora le toca al usuario, ¿entonces el sistema operativo ya no ejecuta más?</div><br /><div style="text-align:left;">Recordemos una de las tareas del sistema operativo:</div><ul style="font-size:24px;"><li>Permitir que el usuario pueda utilizar el computador</li><li>Sistema operativo debe mantener el computador disponible para el usuario</li></ul></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-oslayers-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section><h3>El proceso de arranque</h3><div style="border:none; width:65%; vertical-align:middle; display:inline-block; text-align:left;"><div>Al iniciar el computador se ejecuta código de la tarjeta madre</div><ul style="font-size:24px;"><li><a href="https://en.wikipedia.org/wiki/BIOS">BIOS</a>: <i>Basic Input/Output System</i>, o bien</li><li><a href="https://en.wikipedia.org/wiki/Unified_Extensible_Firmware_Interface">UEFI</a>: <i>Unified Extensible Firmware Interface</i></li></ul><br /><div>Este código tiene dos misiones fundamentales</div><ul style="font-size:24px;"><li>Inicializar/identificar el <i>hardware</i></li><li>Ubicar y arrancar mediante un <i>bootloader</i> el <i>kernel</i> en modo privilegiado</li></ul><br /><blockquote style="background: #F4C7C3;">El <i>kernel</i> es el <b>único</b> <i>software</i> que funciona en modo privilegiado</blockquote></div><div style="border:none; width:35%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-boot-1.png" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /><img src="../images/figures/00-bios-uefi.jpg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /><div style="font-size:14px; text-align:left;">Fuente: <a href="https://neosmart.net/wiki/mbr-boot-process/">https://neosmart.net/wiki/mbr-boot-process/</a></div><div style="font-size:14px; text-align:left;">Fuente: <a href="http://www.unhappyghost.com/2014/05/bios-vs-uefi-booting.html">http://www.unhappyghost.com/2014/05/bios-vs-uefi-booting.html</a></div></div></section><section><h3>Modos de protección</h3><div style="border:none; width:60%; vertical-align:middle; display:inline-block; text-align:left;"><div>El <i>hardware</i> posee dos modos de protección</div><ul style="font-size:24px;"><li><b>Kernel mode</b>: acceso completo al <i>hardware</i></li><ul style="font-size:20px;"><li>a.k.a. <i>Privileged</i> | <i>Supervised</i> | <i>Monitor</i> | <i>System</i> mode</li></ul><li><b>User mode</b>: acceso a un set restringido de instrucciones</li></ul><ul style="font-size:24px;"><li><i>Hardware</i> genera una interrupción (<i>protection fault</i>), o bien</li><li>Ignora la instrucción</li></ul><blockquote style="background: #F4C7C3;">El <i>kernel</i> es el <b>único</b> <i>software</i> que funciona en modo privilegiado</blockquote></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block; text-align:center;"><img src="../images/figures/00-oskerneluser1-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-transition="fade"><h3>Modos de protección</h3><div style="border:none; width:60%; vertical-align:middle; display:inline-block; text-align:left;"><div>Instrucciones privilegiadas (<i>ring 0</i>)</div><ul style="font-size:24px;"><li>Modificar <i>vector de interrupciones</i> (<code>CLI</code>, <code>IRET</code>)</li><li>Acceder a dispositivos de I/O</li><li>Modificar <i>timer</i> del computador</li><li>Detener el computador (<i>halt</i>, <code>HLT</code>)</li><li>Cambiar el modo de protección (<i>user</i> a <i>kernel</i>, o viceversa)</li><li>Modificar tablas de acceso a memoria (<i>pagetable</i>, <code>INVLPG</code>)</li><li>Almacenar estado de la máquina (<code>SMSW</code>)</li></ul><br /><div>Estas instrucciones son un ejemplo de las instrucciones privilegiadas del <a href="https://software.intel.com/sites/default/files/managed/a4/60/325383-sdm-vol-2abcd.pdf">set de instrucciones Intel 64</a>.</div><br /><div><i>Hardware</i> moderno posee 4 o más modos de protección</div><ul style="font-size:24px;"><li>Se les llama <i>rings</i> (anillos) de protección</li><li>Permite implementar <b>virtualización</b></li><li>Intel 64 posee 4 niveles (<a href="https://software.intel.com/sites/default/files/managed/a4/60/325384-sdm-vol-3abcd.pdf">sección 5.5</a>) y una lista de instrucciones privilegiadas (<a href="https://software.intel.com/sites/default/files/managed/a4/60/325384-sdm-vol-3abcd.pdf">sección 5.9</a>)</li></ul></div><div style="border:none; width:40%; vertical-align:middle; display:inline-block; text-align:center;"><img src="../images/figures/00-osprivilegerings-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="75%" /></div></section><section data-transition="fade"><h3>Interrupciones</h3><blockquote style="background: #F4C7C3;">Los Sistemas Operativos son manejados por <b>interrupciones</b> / <b>traps</b>.</blockquote><div style="text-align:center;">Mientras nadie lo llame, el sistema operativo no hace nada.</div><ul style="font-size:28px;"><li>Programa de usuario genera un <i>trap</i>: interrupción generada por software</li><li>Control pasa al sistema operativo: <i>kernel space</i></li><li>Sistema operativo ejecuta servicio solicitado por el usuario</li><li>Una vez terminado el servicio, sistema operativo regresa el control al programa de usuario</li></ul><div style="border:none; width:100%; vertical-align:middle; display:inline-block; text-align:center;"><img src="../images/figures/00-osinterrupt-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="50%" /></div></section></section><section><h2><i>Syscalls</i>: llamadas al sistema</h2><section></section><section data-transition="fade"><div style="text-align:center;">Interfaz para solicitar servicios al sistema operativo</div><ul style="font-size:28px;"><li>Manera precisa de llamar al sistema operativo es altamente dependiente del <i>hardware</i></li><li>Sistemas proveen bibliotecas que implementan <i>syscalls</i></li></ul><br /><br /><div style="border:none; width:100%; vertical-align:middle; display:inline-block; text-align:center;"><img src="../images/figures/00-ossyscalls-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="50%" /></div></section><section data-transition="fade"><div>¿Qué hace el sistema operativo ante el siguiente comando?</div><div><code>copy source.txt dest.txt</code></div><br /><div style="border:none; width:55%; vertical-align:middle; display:inline-block; text-align:left;"><ul class="fragment" style="font-size:28px;"><li>Abrir <code>source.txt</code> (<code>stat</code>, <code>open</code>)</li><ul><li style="font-size:20px;">¿existe?, ¿tiene permiso de lectura?, &hellip;</li></ul><li>Abrir <code>dest.txt</code> (<code>stat</code>, <code>open</code>)</li><ul><li style="font-size:20px;">¿existe?, ¿se reemplaza?, ¿se puede escribir?, &hellip;</li></ul><li>Leer <code>source.txt</code> hacia alguna región de memoria (<code>mmap</code>, <code>read</code>)</li><li>Escribir desde la memoria hacia <code>dest.txt</code> (<code>write</code>)</li><li>Liberar la memoria y guardar los archivos (<code>munmap</code>, <code>close</code>)</li></ul><br /><br /></div><div style="border:none; width:45%; vertical-align:middle; display:inline-block; text-align:left;"><img src="../images/figures/00-ossyscalls2-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div><div class="fragment"><div>Todas estas acciones requieren llamadas al sistema</div><br /><div>Pruebe con: <code>strace cp source.txt dest.txt</code></div></div></section><section><div style="text-align:center;">Definir una interfaz estándar ayuda a la portabilidad</div><ul style="font-size:28px;"><li><a href="http://standards.ieee.org/develop/wg/POSIX.html">POSIX</a>, interfaz definida en IEEE1003.1-2017</li><li>SCI, System Call Interface. Interfaz de <i>syscalls</i> de Linux</li><li>Linux kernel API: interfaz SCI + implementación en <code>glibc</code></li><li>Windows NT Native API, interfaz para Windows NT. Implementada en <code>ntdll.dll</code></li><li>Windows API (Win32), en <code>kernel32.dll</code>, <code>advapi32.dll</code>, <code>user32.dll</code></li></ul><div><img src="../images/figures/00-LinuxAPI.png" style="background:none; border:none; box-shadow:none;" width="40%">&nbsp;&nbsp;</img><img src="../images/figures/00-WinArch.png" style="background:none; border:none; box-shadow:none;" width="40%" /></div></section><section data-transition="fade"><div style="border:none; width:50%; vertical-align:middle; display:inline-block; text-align:left;"><div style="text-align:center;">¿Cómo se ejecuta una <i>syscall</i>?</div><div style="text-align:center;">Procedimiento es dependiente del <i>hardware</i></div><br /><div>Participan:</div><ul style="font-size:24px;"><li>Proceso ejecutable de usuario</li><li>Biblioteca (estática o dinámica) que invoca la <i>syscall</i></li><li>Vector de interrupciones del <i>hardware</i>, configurado por el sistema operativo</li><li>Código de <i>syscalls</i> del sistema operativo, que utilizan el <i>hardware</i></li></ul><br /><br /><div>¿Qué hace <code>read</code>? <a href="https://linux.die.net/man/2/read">RTFM</a></div></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block; text-align:left;"><img src="../images/figures/00-ossyscalls4-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section data-transition="fade"><div style="border:none; width:50%; vertical-align:middle; display:inline-block; text-align:left;"><div style="text-align:center;">¿Cómo se ejecuta una <i>syscall</i>?</div><div>Ejemplo basado en Linux e Intel64</div><ol style="font-size:24px;"><li>Proceso de usuario invoca rutina de biblioteca <code>read</code></li><li>Implementación de <code>read</code> prepara la invocación configurando el <i>stack</i> y el registro <code>eax</code></li><li>Generación de interrupción: <code>int 0x80</code>. Intel64 usa (fast) <code>syscall</code></li><li><i>Hardware</i> pasa de modo <i>user</i> a <i>kernel</i> y actúa de acuerdo al vector de interrupciones</li><li>Vector de interrupciones ejecuta instrucción <code>system_call</code> del sistema operativo</li><li>Sistema operativo obtiene número de <i>syscall</i> desde <code>eax</code>, y configura <i>stack</i> para poder retornar al usuario</li><li>Sistema operativo ejecuta el código de <code>sys_write</code></li><li>Ejecución de <code>sys_write</code> recupera argumentos, ejecuta acción, y deja valor de retorno en <code>eax</code></li><li>Sistema operativo cambio modo a <i>user</i>, y <code>sys_write</code> retorna al código de la biblioteca (<code>sysexit</code>)</li><li>Código de biblioteca recupera el valor de retorno de la <i>syscall</i> y lo entrega al proceso de usuario</li></ol></div><div style="border:none; width:50%; vertical-align:middle; display:inline-block; text-align:left;"><img src="../images/figures/00-ossyscalls3-opt.svg" style="background:none; border:none; box-shadow:none; vertical-align:middle;" width="100%" /></div></section><section><div style="width:50%; vertical-align:middle; display:inline-block;"><div>Algunas <i>syscalls</i> de POSIX. </div><br /><div>Lista de <a href="https://github.com/torvalds/linux/blob/master/include/uapi/asm-generic/unistd.h"><i>syscalls</i> de Linux</a></div><ul style="font-size:24px;"><li>Más claro con: <a href="http://man7.org/linux/man-pages/man2/syscalls.2.html"><code>man syscalls</code></a></li></ul></div><div style="width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-syscalls-posix.png" style="background:none; border:none; box-shadow:none;" width="80%" /></div></section><section><div style="width:50%; vertical-align:middle; display:inline-block;"><div>Algunas <i>syscalls</i> de POSIX y su equivalencia en Win32 </div><br /><ul style="font-size:28px;"><li>Es natural que no todas las <i>syscall</i> tenga una equivalencia.</li><li>Cada sistema provee su propio conjunto de instrucciones para interactuar con el usuario</li></ul></div><div style="width:50%; vertical-align:middle; display:inline-block;"><img src="../images/figures/00-syscalls-posix-win32.png" style="background:none; border:none; box-shadow:none;" width="100%" /></div></section></section><section><h2>Arquitecturas y llamadas al sistema</h2><section><div style="width:60%; vertical-align:middle; display:inline-block; text-align:left;"><div>Sistemas Operativos proveen niveles de abstracción</div><ul style="font-size:24px;"><li><a href="https://manybutfinite.com/post/when-does-your-os-run/">¿Cuándo ejecuta el sistema operativo?</a></li></ul><br /><br /><div>Protección entre espacios de <i>user</i> y <i>kernel</i></div><ul style="font-size:24px;"><li>Cuánto queda en <i>kernel space</i> y en <i>user space</i> determina si el <i>kernel</i> es monolítico o microkernel </li></ul><br /><br /><div>Usuario solicita servicios a través de <i>syscalls</i></div><ul style="font-size:24px;"><li>Todas las funciones definidas por <a href="http://pubs.opengroup.org/onlinepubs/9699919799/nframe.html">POSIX</a></li><li>En Linux, la función <a href="http://man7.org/linux/man-pages/man2/syscall.2.html"><code>syscall</code></a> permite invocar cualquier <i>syscall</i> ... <code>man syscall</code></li><li>Todas las <a href="https://www.intel.com/content/dam/www/public/us/en/documents/manuals/64-ia-32-architectures-software-developer-instruction-set-reference-manual-325383.pdf">instrucciones de Intel64</a></li><li>Tutorial: Como crear <a href="https://brennan.io/2016/11/14/kernel-dev-ep3/">su propia <i>syscall</i></a></li></ul><br /><br /><div>Sistema operativo es una pieza de <i>software</i> compleja ... y fascinante</div><ul style="font-size:24px;"><li><a href="https://wiki.osdev.org/Getting_Started">¿Quieres construir uno?</a></li></ul></div><div style="width:40%; vertical-align:middle; display:inline-block;"><img alt="Abstraction" src="../images/figures/00-xkcd-abstraction.png" style="background:none; border:none; box-shadow:none;" title="If I'm such a god, why isn't Maru *my* cat?" width="100%" /><div style="font-size:12px;"><a href="https://explainxkcd.com/676/">Explicación</a></div></div></section></section></div></div><script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/lib/js/head.min.js"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/js/reveal.min.js"></script><script>// Full list of configuration options available at:
// https://github.com/hakimel/reveal.js#configuration
Reveal.initialize({
    width: 1600,
    height: 900,

    controls: true,
    progress: true,
    history: true,
    center: true,

    transition: 'slide', // none/fade/slide/convex/concave/zoom

    math: {
        //mathjax: 'https://cdn.mathjax.org/mathjax/latest/MathJax.js',
        //Migrated. Check here: https://www.mathjax.org/cdn-shutting-down/
        mathjax: 'https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js',
        // config: 'TeX-AMS_HTML-full'  // See http://docs.mathjax.org/en/latest/config-files.html
        config: 'TeX-AMS-MML_HTMLorMML'  // See http://docs.mathjax.org/en/latest/config-files.html
    },

    // Optional reveal.js plugins
    dependencies: [

        // Cross-browser shim that fully implements classList - https://github.com/eligrey/classList.js/
        { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/lib/js/classList.min.js', condition: function() { return !document.body.classList; } },

        // Markdown
        { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/plugin/markdown/marked.min.js', condition: function() { return !!document.querySelector( '[data-markdown]' ); } },
        { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/plugin/markdown/markdown.min.js', condition: function() { return !!document.querySelector( '[data-markdown]' );} },

        // Highlight <code>
        { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/plugin/highlight/highlight.min.js', async: true, callback: function() { hljs.initHighlightingOnLoad(); } },

        // Mathjax
        { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/plugin/math/math.min.js', async: true },

        // Zoom
        { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/plugin/zoom-js/zoom.min.js', async: true },

        // Speaker Notes
        { src: 'https://cdnjs.cloudflare.com/ajax/libs/reveal.js/3.2.0/plugin/notes/notes.min.js', async: true }

        // Title footer
        //{ src: '/js/plugin/title-footer/title-footer.js', async: true, callback: function() { title_footer.initialize(); } }
    ]
});</script></body></html>